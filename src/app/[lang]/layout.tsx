import type { Metadata } from 'next';
import { GoogleTagManager } from '@next/third-parties/google';
import { Poppins } from 'next/font/google';
import { Toaster } from 'react-hot-toast';

import { i18n, Locale } from '../../../i18n.config';
import { getDictionary } from '@/utils/dictionaries';

import DictionaryProvider from '@/providers/DictionaryProvider';
import ThemeProvider from '@/providers/ThemeProvider';
import QueryClientProvider from '@/providers/QueryClientProvider';

import '@radix-ui/themes/styles.css';
import './theme-config.css';
import './globals.css';

type Props = Readonly<{ children: React.ReactNode; params: { lang: Locale } }>;

const poppins = Poppins({
	subsets: ['latin'],
	weight: ['100', '200', '300', '400', '500', '600', '700', '800', '900'],
});

export const metadata: Metadata = {
	title: 'Exactrem',
	description: 'Generated by create next app',
};

export async function generateStaticParams() {
	return i18n.locales.map((locale) => ({ lang: locale }));
}

async function RootLayout({ children, params }: Props) {
	const dictionary = await getDictionary(params.lang);

	return (
		<html lang={params.lang}>
			<GoogleTagManager gtmId={process.env.NEXT_GTM as string} />

			<body className={poppins.className}>
				<Toaster position="bottom-center" />

				<QueryClientProvider>
					<DictionaryProvider dictionary={dictionary}>
						<ThemeProvider>{children}</ThemeProvider>
					</DictionaryProvider>
				</QueryClientProvider>
			</body>
		</html>
	);
}

export default RootLayout;
